# EDA 전략 및 실행 계획

## 🎯 EDA 목표 및 철학

### 핵심 목표
1. **데이터 품질 검증**: 결측치, 이상치, 데이터 불일치 파악
2. **문제 이해 심화**: 예측 대상(마지막 패스)의 특성 파악
3. **패턴 발견**: 시공간적 패턴, 전술적 패턴 발견
4. **모델링 방향 설정**: EDA 결과를 기반으로 피처/모델 전략 수립

### EDA 철학
- **Text 기반 인사이트 우선**: 수치로 정량화된 인사이트 출력
- **시각화는 검증 수단**: 그래프는 인사이트를 뒷받침하는 보조 자료
- **단계적 심화**: 기본 → 심화 → 도메인 특화 순서로 진행
- **실행 가능한 결론**: 각 분석마다 "이것이 모델링에 어떻게 활용되는가?" 명시

---

## 📋 EDA 실행 계획

### Phase 1: 데이터 기초 진단 (Foundation)
**목적**: 데이터의 기본 구조와 품질 파악

#### 1.1 데이터 로딩 및 구조 파악
- [ ] Train 데이터 로딩 전략 수립 (대용량 파일)
- [ ] Test 데이터 구조 파악 (개별 CSV 구조)
- [ ] 전체 데이터 크기 및 메모리 요구사항 추정

**출력 인사이트**:
- 총 에피소드 수 (Train/Test)
- 총 이벤트 수
- 평균 에피소드 길이 (이벤트 개수)
- 메모리 사용량

#### 1.2 결측치 및 데이터 품질
- [ ] 컬럼별 결측치 비율 및 패턴
- [ ] player_id 결측치: 어떤 이벤트 타입에서 발생하는가?
- [ ] end_x, end_y 결측치: 마지막 이벤트에만 발생하는가?
- [ ] 좌표 범위 검증 (0≤x≤105, 0≤y≤68)

**출력 인사이트**:
- 컬럼별 결측치 비율 및 해석
- 비정상 좌표 개수 및 패턴
- 데이터 정제 필요 여부 판단

#### 1.3 시간 정합성 검증
- [ ] action_id vs time_seconds 순서 불일치 비율
- [ ] 에피소드 내 시간 역전 사례 확인
- [ ] 에피소드 간 경계 검증

**출력 인사이트**:
- 순서 불일치 비율 및 처리 방안
- 시간 정렬 필요성 판단

---

### Phase 2: 예측 대상 분석 (Target Analysis)
**목적**: 예측할 "마지막 패스"의 특성 이해

#### 2.1 마지막 패스 기본 통계
- [ ] 마지막 패스의 좌표 분포 (end_x, end_y)
- [ ] 경기장 영역별 빈도 (수비진/중원/공격진)
- [ ] 좌우 편향성 (중앙 vs 사이드)

**출력 인사이트**:
- 평균 좌표, 중앙값, 표준편차
- 가장 빈번한 영역 (히트맵 요약)
- 단순 평균 예측 시 베이스라인 성능 (유클리드 거리)

#### 2.2 마지막 패스 타입 분석
- [ ] type_name 분포 (Pass, Cross, Pass_Freekick 등)
- [ ] result_name 분포 (Successful vs Unsuccessful)
- [ ] 특수 상황 비율 (코너킥, 프리킥)

**출력 인사이트**:
- 가장 흔한 마지막 패스 타입 Top 5
- 성공률 및 실패 시 좌표 차이
- 특수 상황별 예측 난이도 추정

#### 2.3 시작 위치와 도착 위치의 관계
- [ ] start → end 거리 분포
- [ ] 이동 방향 (전진/후진/측면)
- [ ] 시작 위치별 도착 위치 클러스터링

**출력 인사이트**:
- 평균 패스 거리, 최대/최소 거리
- 전진 패스 비율
- 위치 관계의 선형성/비선형성 판단

---

### Phase 3: 시퀀스 특성 분석 (Sequence Analysis)
**목적**: 에피소드 내 이벤트 시퀀스의 패턴 파악

#### 3.1 에피소드 길이 분석
- [ ] 에피소드당 이벤트 개수 분포
- [ ] 짧은 에피소드 vs 긴 에피소드 특성
- [ ] 최적 시퀀스 길이 결정 (Padding/Truncation 기준)

**출력 인사이트**:
- 최소/최대/평균/중앙값 에피소드 길이
- 백분위수 분포 (25%, 50%, 75%, 90%, 95%, 99%)
- 권장 시퀀스 길이 (예: 95% 커버)

#### 3.2 이벤트 타입 시퀀스 패턴
- [ ] 가장 흔한 이벤트 타입 Top 10
- [ ] 이벤트 타입 전이 확률 (Bigram, Trigram)
- [ ] 마지막 패스 직전 N개 이벤트 패턴

**출력 인사이트**:
- 전형적인 플레이 패턴 (예: Pass→Carry→Pass)
- 마지막 패스 전 가장 흔한 시퀀스 Top 5
- 특이 패턴 발견 시 해석

#### 3.3 시간적 특성
- [ ] 에피소드 지속 시간 분포
- [ ] 이벤트 간 평균 시간 간격
- [ ] 시간대별 플레이 밀도 (전반/후반 초중후반)

**출력 인사이트**:
- 평균 에피소드 지속 시간
- 빠른 템포 vs 느린 템포 에피소드 비율
- 시간 압박이 패스 좌표에 미치는 영향

---

### Phase 4: 공간적 패턴 분석 (Spatial Analysis)
**목적**: 경기장 내 공간 활용 패턴 파악

#### 4.1 경기장 영역 분석
- [ ] 경기장을 그리드로 나누어 활동 빈도 계산
- [ ] 영역별 패스 성공률
- [ ] 위험 지역(골 근처) vs 안전 지역 차이

**출력 인사이트**:
- 가장 활발한 영역 Top 5
- 영역별 평균 패스 거리/방향
- 공격 패턴 (사이드 vs 중앙 비율)

#### 4.2 골 방향성 분석
- [ ] 골문까지의 거리별 플레이 특성
- [ ] 골문 각도별 패스 방향
- [ ] 공격 진전도 (에피소드 내 x 좌표 변화)

**출력 인사이트**:
- 골에 가까울수록 패스 정확도 변화
- 중앙 돌파 vs 측면 공략 성공률
- 전진성 패스 비율

#### 4.3 대칭성 및 편향 분석
- [ ] 좌측 vs 우측 공격 편향
- [ ] 홈팀 vs 어웨이팀 공간 활용 차이
- [ ] 데이터 증강 가능성 검증 (좌우 반전)

**출력 인사이트**:
- 좌우 대칭성 정도 (상관계수)
- 데이터 증강 타당성 판단
- 편향 보정 필요성

---

### Phase 5: 팀 및 선수 분석 (Team & Player Analysis)
**목적**: 팀/선수 레벨의 특성 파악

#### 5.1 팀별 플레이 스타일
- [ ] 팀별 평균 패스 개수
- [ ] 팀별 공간 활용 패턴
- [ ] 홈/어웨이 효과

**출력 인사이트**:
- 보유 중심 팀 vs 역습 팀 구분
- 팀 임베딩 필요성 판단
- 홈 어드밴티지 정량화

#### 5.2 선수별 특성
- [ ] 선수별 이벤트 빈도
- [ ] 주요 선수 (Top 20) 패스 특성
- [ ] 포지션별 플레이 패턴 (추정)

**출력 인사이트**:
- 핵심 선수 vs 일반 선수 구분 기준
- 선수 임베딩 vs 집계 피처 선택
- 포지션 추정 가능성

#### 5.3 경기 맥락
- [ ] 득점 차이에 따른 플레이 변화
- [ ] 경기 시간대별 전술 변화
- [ ] 중요 경기 vs 일반 경기

**출력 인사이트**:
- 맥락 피처의 중요도 추정
- 게임 상황 인코딩 전략

---

### Phase 6: 문제 난이도 분석 (Difficulty Analysis)
**목적**: 예측 난이도 및 잠재적 문제점 파악

#### 6.1 예측 가능성 분석
- [ ] 직전 이벤트 위치 → 마지막 패스 상관관계
- [ ] 시퀀스 길이별 예측 난이도
- [ ] 단순 규칙 기반 베이스라인 성능

**출력 인사이트**:
- 선형 모델로 예측 가능한 정도
- 복잡한 모델이 필요한 이유
- 예상 성능 상한선

#### 6.2 Train vs Test 분포 비교
- [ ] Train/Test 에피소드 길이 분포 비교
- [ ] 이벤트 타입 분포 비교
- [ ] 공간적 분포 비교

**출력 인사이트**:
- 분포 차이 정도 (KL Divergence, Wasserstein Distance)
- Overfitting 위험도
- 검증 전략 방향성

#### 6.3 이상치 및 특수 케이스
- [ ] 극단적인 에피소드 (매우 짧거나 긺)
- [ ] 비정상적인 좌표 이동
- [ ] 희귀 이벤트 타입

**출력 인사이트**:
- 이상치 비율 및 처리 방안
- 특수 케이스 처리 전략
- Robust 모델 필요성

---

## 📊 출력 형식 표준

각 분석마다 다음 형식으로 출력:

```
=== [분석 제목] ===

[1. 핵심 발견 (Key Findings)]
- 발견 1: 수치와 함께
- 발견 2: 수치와 함께
- ...

[2. 통계 요약 (Statistical Summary)]
- 평균: X, 중앙값: Y, 표준편차: Z
- 최소/최대: A / B
- ...

[3. 인사이트 (Insights)]
- 이것이 의미하는 바는...
- 예상되는 영향은...
- 주의할 점은...

[4. 모델링 시사점 (Modeling Implications)]
- 피처 엔지니어링: ...
- 모델 선택: ...
- 전처리 전략: ...

[5. 다음 분석 방향 (Next Steps)]
- 추가로 확인할 사항...

========================================
```

---

## 🔧 기술적 접근

### 코드 구조
```
eda_analysis.py
├── 데이터 로딩 함수
├── Phase별 분석 함수
│   ├── analyze_data_quality()
│   ├── analyze_target_variable()
│   ├── analyze_sequences()
│   ├── analyze_spatial_patterns()
│   ├── analyze_teams_players()
│   └── analyze_difficulty()
└── 유틸리티 함수
    ├── print_section()
    ├── calculate_stats()
    └── save_insights()
```

### 성능 최적화
- 대용량 데이터는 청크 단위로 읽기
- 필요시 샘플링 (대표성 유지)
- 결과는 텍스트 파일로 저장 (버전 관리)

### 인사이트 관리
- `EDA_insights.txt`: 모든 인사이트 누적 저장
- 각 Phase별로 섹션 구분
- 타임스탬프 기록

---

## 📅 실행 순서

1. **Phase 1 실행** → 인사이트 검토 → 필요시 추가 분석
2. **Phase 2 실행** → 인사이트 검토 → 필요시 추가 분석
3. **Phase 3-6 순차 실행**
4. **종합 인사이트 정리**
5. **모델링 전략 수립**

---

## ✅ 성공 기준

- [ ] 모든 데이터 품질 이슈 파악
- [ ] 예측 대상의 특성 정량화
- [ ] 최소 5개 이상의 실행 가능한 모델링 인사이트 도출
- [ ] Train/Test 분포 차이 이해
- [ ] 베이스라인 성능 추정
- [ ] 인사이트 문서 작성 완료


