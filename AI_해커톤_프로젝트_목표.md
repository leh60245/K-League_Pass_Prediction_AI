# K리그-서울시립대 AI 경진대회 프로젝트 목표

## 📋 대회 개요
**대회명**: K리그 경기 내 최종 패스 좌표 예측 AI 모델 개발  
**평가지표**: 유클리드 거리 (Euclidean Distance) - 낮을수록 좋음  
**목표**: 주어진 플레이 시퀀스의 마지막 패스 도착 좌표(X, Y)를 예측

---

## 🎯 1단계: 문제 정의 (Problem Definition)

### 1.1 핵심 과제
- **입력**: 경기 내 에피소드별 시퀀스 데이터 (여러 이벤트들의 시계열)
- **출력**: 에피소드의 마지막 패스의 도착 좌표 (end_x, end_y)
- **좌표계**: 105 x 68 그리드 (FIFA 공식 규격), 좌→우 공격 방향으로 통일

### 1.2 문제의 특성
- **시계열 데이터**: 시간 순서에 따른 이벤트 발생
- **공간 데이터**: 2D 좌표 상에서의 움직임 패턴
- **맥락 이해**: 선수 배치, 상대 압박, 공격 전개 방향 등 복합적 요인 고려
- **전술적 의도 파악**: 단순 패스 위치가 아닌 "왜 그 위치가 최적인가" 이해 필요

### 1.3 성공 기준
- **Primary**: Public Score (테스트 데이터 30%) 최소화
- **Secondary**: Private Score (테스트 데이터 100%) 최소화
- **Target**: 유클리드 거리 기준 상위 10% 진입

---

## 🔍 2단계: 데이터 이해 및 탐색 (Data Understanding & EDA)

### 2.1 데이터 구조 파악
- [x] train.csv: 대용량 시퀀스 데이터 (파일이 커서 개별 에피소드로 나뉘어 있을 가능성)
- [x] test.csv: 2,415개 에피소드 (각 에피소드는 개별 CSV 파일로 저장)
- [x] match_info.csv: 230경기 메타데이터
- [x] sample_submission.csv: 제출 형식 (game_episode, end_x, end_y)

### 2.2 EDA 목표
#### 2.2.1 기본 통계
- [ ] Train/Test 에피소드 개수 및 분포
- [ ] 에피소드당 평균 이벤트 개수
- [ ] 에피소드 시간 길이 분포
- [ ] 이벤트 타입별 빈도 분석

#### 2.2.2 공간 분석
- [ ] 패스 도착 좌표 (end_x, end_y) 분포 시각화
- [ ] 경기장 영역별 패스 빈도 히트맵
- [ ] 공격 방향별 패스 패턴 분석
- [ ] 홈/어웨이 팀별 공간 활용 차이

#### 2.2.3 시계열 분석
- [ ] 시간대별 플레이 패턴 변화
- [ ] 에피소드 시작 위치 vs 종료 위치 관계
- [ ] 전/후반별 특성 차이
- [ ] 연속된 이벤트 간 관계성 분석

#### 2.2.4 이벤트 타입 분석
- [ ] 성공/실패 패스 비율
- [ ] 특정 이벤트 시퀀스 패턴 (Pass → Carry → Pass 등)
- [ ] 크로스, 프리킥 등 특수 상황 분석
- [ ] 마지막 패스 직전 이벤트 패턴 분석

#### 2.2.5 선수 및 팀 분석
- [ ] 선수별 패스 성공률 및 특성
- [ ] 팀별 전술적 특성 (보유율, 패스 스타일)
- [ ] 홈/어웨이 효과 분석

---

## 🧹 3단계: 데이터 전처리 (Data Preprocessing)

### 3.1 결측치 처리
- [ ] player_id 결측치 확인 및 처리 전략 수립
- [ ] end_x, end_y 결측치 패턴 분석 (테스트 데이터의 마지막 행)
- [ ] result_name NaN 값 처리 (특정 이벤트는 성공/실패 없음)

### 3.2 데이터 정합성 검증
- [ ] action_id와 time_seconds 순서 불일치 확인
- [ ] 에피소드 경계 검증
- [ ] 좌표 범위 검증 (0 ≤ x ≤ 105, 0 ≤ y ≤ 68)
- [ ] 이상치(Outlier) 탐지 및 처리

### 3.3 데이터 변환
- [ ] 범주형 변수 인코딩 (type_name, result_name)
- [ ] 좌표 정규화/스케일링 전략 수립
- [ ] 시간 정보 변환 (상대 시간, 구간화 등)

### 3.4 시퀀스 데이터 구성
- [ ] 에피소드별 시퀀스 길이 표준화 (Padding/Truncation)
- [ ] 시퀀스 길이 분포 분석 후 최대 길이 결정
- [ ] 가변 길이 처리 전략 (Masking, Attention 등)

---

## 🔧 4단계: 피처 엔지니어링 (Feature Engineering)

### 4.1 기본 피처
- [ ] 이벤트 간 거리 (유클리드, 맨해튼)
- [ ] 이벤트 간 시간 차이
- [ ] 이동 방향 (각도, 벡터)
- [ ] 이동 속도 (거리/시간)

### 4.2 공간적 피처
- [ ] 골문까지의 거리
- [ ] 골문에 대한 각도
- [ ] 경기장 영역 구분 (수비진, 중원, 공격진)
- [ ] 필드 중앙으로부터의 거리
- [ ] 사이드 공격 vs 중앙 공격 구분

### 4.3 시계열 피처
- [ ] 이벤트 누적 통계 (에피소드 내)
- [ ] 롤링 윈도우 통계 (최근 N개 이벤트)
- [ ] 에피소드 경과 시간 비율
- [ ] 전반/후반 잔여 시간

### 4.4 전술적 피처
- [ ] 연속 패스 횟수
- [ ] 공격 진전도 (x 좌표 변화)
- [ ] 패스 네트워크 중심성 (선수별)
- [ ] 압박 강도 (상대팀 이벤트 빈도)
- [ ] 공간 점유율 (영역별 이벤트 밀도)

### 4.5 맥락 피처
- [ ] 팀 ID, 홈/어웨이
- [ ] 경기 상황 (득점 차이 - match_info 활용)
- [ ] 이전 이벤트 타입 시퀀스 (N-gram)
- [ ] 마지막 패스 직전 K개 이벤트 특성

### 4.6 집계 피처
- [ ] 선수별 평균 패스 위치
- [ ] 팀별 전형적인 플레이 패턴
- [ ] 경기별 평균 통계

---

## 🏗️ 5단계: 모델 구조 정립 (Model Architecture)

### 5.1 베이스라인 모델
#### 5.1.1 통계적 접근
- [ ] 평균/중앙값 예측 (가장 단순한 베이스라인)
- [ ] 직전 패스 위치 기반 예측
- [ ] K-NN 기반 유사 시퀀스 검색

#### 5.1.2 전통적 ML 모델
- [ ] XGBoost / LightGBM (피처 집계 후)
- [ ] Random Forest
- [ ] Linear Regression (단순 베이스라인)

### 5.2 딥러닝 모델 (주력 모델)
#### 5.2.1 시퀀스 모델
- [ ] **LSTM** / **GRU**: 시계열 이벤트 인코딩
  - Bidirectional 적용 고려
  - 다층 구조 실험
- [ ] **Transformer** / **Temporal Fusion Transformer**
  - Self-Attention으로 중요 이벤트 가중
  - Positional Encoding 전략
  
#### 5.2.2 시공간 모델
- [ ] **Graph Neural Network (GNN)**
  - 선수 간 관계를 그래프로 모델링
  - Spatial-Temporal GNN
- [ ] **Conv1D + LSTM** 하이브리드
  - 1D CNN으로 로컬 패턴 추출
  - LSTM으로 장기 의존성 학습

#### 5.2.3 최신 접근법
- [ ] **Trajectory Prediction 모델** (Social GAN, Trajectron++ 등 변형)
- [ ] **Set2Set** / **PointNet** 변형 (에피소드를 점 집합으로 처리)
- [ ] **BERT 스타일 마스킹** (중간 이벤트 마스킹 후 예측)

### 5.3 앙상블 전략
- [ ] 모델 다양성 확보 (LSTM + Transformer + GBM)
- [ ] Stacking / Blending
- [ ] 가중 평균 (성능 기반)

### 5.4 손실 함수 설계
- [ ] **MSE Loss**: 기본 회귀 손실
- [ ] **Huber Loss**: 이상치에 강건
- [ ] **사용자 정의 Loss**: 유클리드 거리 직접 최적화
- [ ] **Multi-task Loss**: 좌표 예측 + 보조 태스크 (이벤트 타입 예측 등)

---

## 🎓 6단계: 모델 학습 및 검증 (Training & Validation)

### 6.1 검증 전략
- [ ] **Time-based Split**: 시간 순서 고려 (초기 경기 → 최신 경기)
- [ ] **Game-based Split**: 경기 단위 분할 (특정 경기 전체를 검증셋으로)
- [ ] **K-Fold Cross Validation**: 안정적인 성능 평가
- [ ] Public LB와 검증셋 상관관계 분석

### 6.2 학습 최적화
- [ ] Learning Rate Scheduler (CosineAnnealing, ReduceLROnPlateau)
- [ ] Early Stopping (Patience 설정)
- [ ] Gradient Clipping (시퀀스 모델 안정화)
- [ ] Weight Decay / Dropout (과적합 방지)

### 6.3 데이터 증강
- [ ] 좌표 회전 (대칭성 활용)
- [ ] 좌표 이동 (Translation)
- [ ] 노이즈 추가 (Gaussian Noise)
- [ ] 시퀀스 샘플링 (일부 이벤트 제거)

### 6.4 하이퍼파라미터 튜닝
- [ ] Optuna / Ray Tune 활용
- [ ] 주요 파라미터: hidden_dim, num_layers, dropout, batch_size
- [ ] 학습률, 시퀀스 길이 최적화

---

## 📊 7단계: 모델 평가 및 분석 (Evaluation & Analysis)

### 7.1 성능 평가
- [ ] 검증셋 유클리드 거리 계산
- [ ] Public LB 제출 및 점수 확인
- [ ] 예측 오차 분포 분석

### 7.2 오류 분석
- [ ] 큰 오차를 보이는 에피소드 분석
- [ ] 특정 이벤트 타입별 성능 차이
- [ ] 경기장 영역별 예측 정확도
- [ ] 시퀀스 길이에 따른 성능 변화

### 7.3 모델 해석
- [ ] Feature Importance (GBM 모델)
- [ ] Attention Weights 시각화 (Transformer)
- [ ] SHAP / LIME 분석
- [ ] 예측 시각화 (실제 vs 예측 좌표)

### 7.4 앙상블 최적화
- [ ] 모델별 강점/약점 파악
- [ ] 최적 가중치 탐색
- [ ] 다양한 앙상블 조합 실험

---

## 🚀 8단계: 최종 제출 준비 (Submission Preparation)

### 8.1 코드 정리
- [ ] 학습 코드 정리 및 문서화
- [ ] 추론 코드 분리 (inference.py)
- [ ] 상대 경로로 수정
- [ ] UTF-8 인코딩 확인

### 8.2 환경 구성
- [ ] requirements.txt 작성 (라이브러리 버전 명시)
- [ ] 환경 설정 정보 문서화
- [ ] 재현 가능성 검증 (새로운 환경에서 테스트)

### 8.3 모델 가중치
- [ ] 최종 모델 가중치 저장
- [ ] 앙상블 사용 시 모든 모델 가중치 포함
- [ ] 파일 크기 확인

### 8.4 솔루션 문서
- [ ] 문제 접근 방법 설명
- [ ] 주요 피처 및 모델 아키텍처
- [ ] 실험 결과 및 인사이트
- [ ] 향후 개선 방향

### 8.5 최종 제출
- [ ] Private Score 복원 가능 확인
- [ ] dacon@dacon.io로 제출
- [ ] 제출 전 체크리스트 검증

---

## 📈 9단계: 성능 개선 전략 (Performance Improvement)

### 9.1 단기 개선 (Quick Wins)
- [ ] 피처 스케일링 최적화
- [ ] 하이퍼파라미터 미세 조정
- [ ] 앙상블 가중치 조정
- [ ] 후처리 (좌표 범위 제한 등)

### 9.2 중기 개선
- [ ] 새로운 피처 추가
- [ ] 모델 아키텍처 변경
- [ ] 데이터 증강 기법 추가
- [ ] Cross Validation 전략 개선

### 9.3 장기 개선
- [ ] 외부 데이터 활용 (가능한 경우)
- [ ] 전술 분석 도메인 지식 통합
- [ ] 고급 시공간 모델 적용
- [ ] 준지도 학습 / 자기 지도 학습

---

## 🎯 마일스톤 및 일정

### Week 1: 데이터 이해 및 베이스라인
- [ ] Day 1-2: EDA 완료
- [ ] Day 3-4: 데이터 전처리 파이프라인
- [ ] Day 5-7: 베이스라인 모델 구축 (XGBoost, 단순 LSTM)

### Week 2: 모델 개발
- [ ] Day 8-10: 피처 엔지니어링
- [ ] Day 11-12: 주력 딥러닝 모델 개발
- [ ] Day 13-14: 모델 튜닝 및 검증

### Week 3: 최적화 및 제출
- [ ] Day 15-17: 앙상블 및 성능 개선
- [ ] Day 18-19: 코드 정리 및 문서화
- [ ] Day 20-21: 최종 제출 준비 및 검증

---

## 💡 핵심 인사이트 및 주의사항

### 핵심 포인트
1. **시계열 + 공간 데이터**: 시간과 위치 정보를 모두 활용해야 함
2. **맥락 이해**: 단순 좌표가 아닌 전술적 의도 파악이 중요
3. **마지막 이벤트**: 에피소드의 마지막 패스가 예측 대상
4. **유클리드 거리**: 회귀 문제이지만 평가는 거리 기반

### 주의사항
- action_id와 time_seconds 순서 불일치 가능 → time_seconds 기준 정렬 필요
- 좌표계 통일 (L→R 공격) → 방향성 고려
- 에피소드 경계 정확히 구분
- Public/Private 데이터 분포 차이 고려
- 과적합 주의 (230경기 정도의 데이터)

### 성공 전략
1. **도메인 지식 활용**: 축구 전술 이해가 큰 도움
2. **시각화**: 예측 결과를 경기장에 시각화하여 직관적 검증
3. **앙상블**: 다양한 모델 조합으로 안정성 확보
4. **반복 실험**: 빠른 프로토타이핑과 피드백 루프

---

## 📚 참고 자료

### 유사 연구/대회
- Trajectory Prediction (보행자, 차량)
- Sports Analytics (축구, 농구 등)
- Event Sequence Prediction

### 논문/기술
- Attention Is All You Need (Transformer)
- Social GAN / Trajectron++
- Graph Networks for Trajectory Prediction
- Temporal Fusion Transformer

### 라이브러리
- PyTorch / TensorFlow (딥러닝)
- PyTorch Geometric (GNN)
- XGBoost / LightGBM (GBM)
- Pandas, NumPy (데이터 처리)
- Matplotlib, Seaborn (시각화)

---

**최종 목표**: Private Score 상위 10% 진입 및 실전 활용 가능한 모델 개발


